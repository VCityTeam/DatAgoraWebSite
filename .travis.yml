os:
 - linux

dist: focal

addons:
  apt:
    packages:
      - python3
      - python3-pip
      - wget
      - openssl

before_install:
  - openssl aes-256-cbc -K $encrypted_bfa1e038770a_key -iv $encrypted_bfa1e038770a_iv -in .ssh/id_rsa.vcity_connect.enc -out id_rsa.vcity_connect -d
  - ls -al .ssh/id_rsa.vcity_rict
  - wc .ssh/id_rsa.vcity_rict

before_script:
  # Requiring a [d|r]ecent version of Hugo
  # References:
  #  - For the Travis phase within the job lifecycle
  #    https://docs.travis-ci.com/user/installing-dependencies/
  #  - For the Hugo install process
  #    https://www.howtoforge.com/how-to-install-hugo-site-generator-on-ubuntu/
  #- wget https://github.com/gohugoio/hugo/releases/download/v0.58.2/hugo_0.58.2_Linux-64bit.deb
  #- sudo dpkg -i hugo_0.58.2_Linux-64bit.deb
  - wget https://github.com/gohugoio/hugo/releases/download/v0.74.3/hugo_0.74.3_Linux-64bit.deb
  - sudo dpkg -i hugo_0.74.3_Linux-64bit.deb
  - hugo version

script:
  - cd LirisProjet/scripts
  - pip3 install -r requirements.txt
  - python3 pub-generator.py
  - cp publications.md ../content/research
  - cd $TRAVIS_BUILD_DIR/LirisProjet
  - hugo
  - which bash

deploy:
  - provider: script
    script: bash $TRAVIS_BUILD_DIR/.travis.deploy.sh
    skip_cleanup: true
    on:
      branch: master
